{% extends "allauth/layouts/base.html" %}
{% load account socialaccount static %}
{% load i18n %}
{% block title %}
  {% trans 'Log In' %}
{% endblock %}
{% block content %}
  <div class="text-center">
    <h2 class="mb-4">{% blocktrans trimmed %}Log in to {{ MY_LII }}{% endblocktrans %}</h2>
    {% include "account/_social_login_buttons.html" %}
  </div>
  {% if AUTH_OTP %}
    <form method="post" action="{% url 'account_login' %}" id="email-login">
      <p>{% trans 'Enter your email address to log in or sign up.' %}</p>
      {% csrf_token %}
      {% if redirect_field_value %}
        <input type="hidden"
               name="{{ redirect_field_name }}"
               value="{{ redirect_field_value }}"/>
      {% endif %}
      {% if form.non_field_errors %}
        <div class="text-danger">
          {% for error in form.non_field_errors %}<p class="m-1">{{ error }}</p>{% endfor %}
        </div>
      {% endif %}
      <div class="mb-4">
        <label class="form-label fw-bold text-dark"
               for="{{ form.login.id_for_label }}">{% trans 'Email address' %}</label>
        <input type="{{ form.login.field.widget.input_type }}"
               class="form-control py-2 px-3 fs-6"
               name="{{ form.login.name }}"
               id="{{ form.login.id_for_label }}"
               required
               autofocus
               placeholder="you@example.com"/>
        {% if form.login.errors %}
          <div class="text-danger">
            {% for error in form.login.errors %}<p class="m-1">{{ error }}</p>{% endfor %}
          </div>
        {% endif %}
      </div>
      <div class="mb-4">
        {{ form.captcha }}
        {% if form.captcha.errors %}
          <div class="text-danger">
            {% for error in form.captcha.errors %}<p class="m-1">{{ error }}</p>{% endfor %}
          </div>
        {% endif %}
      </div>
      <div class="mb-4 d-grid">
        <button class="btn btn-primary" type="submit">{% trans 'Continue' %}</button>
      </div>
      <div class="text-center mt-4 text-secondary">
        {% url 'terms_of_use' as terms_url %}
        {% blocktrans trimmed %}
          By continuing, you agree to our <a href="{{ terms_url }}">Terms of Use</a>.
        {% endblocktrans %}
      </div>
    </form>
  {% else %}
    <form method="post" action="{% url 'account_login' %}" id="email-login">
      <p>{% trans 'Enter your email and password to log in.' %}</p>
      {% csrf_token %}
      {% if redirect_field_value %}
        <input type="hidden"
               name="{{ redirect_field_name }}"
               value="{{ redirect_field_value }}"/>
      {% endif %}
      {% if form.non_field_errors %}
        <div class="text-danger">
          {% for error in form.non_field_errors %}<p class="m-1">{{ error }}</p>{% endfor %}
        </div>
      {% endif %}
      <div class="mb-3">
        <label class="form-label fw-bold text-dark"
               for="{{ form.login.id_for_label }}">{% trans 'Email address' %}</label>
        <input type="{{ form.login.field.widget.input_type }}"
               class="form-control"
               name="{{ form.login.name }}"
               id="{{ form.login.id_for_label }}"
               required
               autofocus
               placeholder="you@example.com"/>
        {% if form.login.errors %}
          <div class="text-danger">
            {% for error in form.login.errors %}<p class="m-1">{{ error }}</p>{% endfor %}
          </div>
        {% endif %}
      </div>
      <div class="mb-3">
        <label class="form-label fw-bold text-dark"
               for="{{ form.password.id_for_label }}">{% trans 'Password' %}</label>
        <input type="password"
               class="form-control"
               name="{{ form.password.name }}"
               id="{{ form.password.id_for_label }}"
               autocomplete="current-password"
               required/>
        {% if form.password.errors %}
          <div class="text-danger">
            {% for error in form.password.errors %}<p class="m-1">{{ error }}</p>{% endfor %}
          </div>
        {% endif %}
      </div>
      <div class="mb-4">
        {{ form.captcha }}
        {% if form.captcha.errors %}
          <div class="text-danger">
            {% for error in form.captcha.errors %}<p class="m-1">{{ error }}</p>{% endfor %}
          </div>
        {% endif %}
      </div>
      <div class="d-grid mb-3">
        <button class="btn btn-primary" type="submit">{% trans 'Log in' %}</button>
      </div>
      <div class="text-center mb-3">
        <a href="{% url 'account_reset_password' %}" class="btn btn-link">{% trans 'Forgot your password?' %}</a>
      </div>
      <div class="text-center">
        {% trans "Don't have an account?" %}
        <a href="{% url 'account_signup' %}">{% trans 'Sign up' %}</a>
      </div>
    </form>
  {% endif %}
{% endblock %}
