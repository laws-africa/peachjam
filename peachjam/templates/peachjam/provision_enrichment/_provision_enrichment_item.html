{% load i18n %}
<div class="card my-4 shadow-sm">
  <div class="card-body">
    <h5 class="card-title">
      <a href="{{ document.get_absolute_url }}" class="">{{ document.title }}</a>
    </h5>
    <ul class="list-unstyled mt-3">
      {% for enrichment in document.provision_enrichments %}
        <li class="mb-4 pb-3 border-bottom">
          <p class="mb-2">
            <a href="#{{ enrichment.provision_eid }}" class="provision-link fw-bold">
              {{ document.title }}#{{ enrichment.provision_eid }}
            </a>
          </p>
          <div class="px-2">
            <p class="my-2">
              <span class="badge bg-danger">{{ enrichment.get_enrichment_type_display }}</span>
              {% if enrichment.resolved %}
                <span class="badge bg-success">{% trans 'Resolved' %}</span>
              {% endif %}
            </p>
            {% if enrichment.provision_by_eid %}
              <la-akoma-ntoso
              frbr-expression-uri="{{ document.expression_frbr_uri }}"
              class="bg-light flash-target content content__akn border-start p-2 border-2 border-danger rounded"
              lang="{{ document.language.iso }}"
              >
              <la-decorate-terms popup-definitions link-terms></la-decorate-terms>
              <la-decorate-internal-refs flag popups></la-decorate-internal-refs>
              {{ enrichment.provision_by_eid|safe }}
              </la-akoma-ntoso>
            {% endif %}
          </div>
          <p class="my-2">{{ enrichment.text }}</p>
          {% if enrichment.enrichment_type == 'unconstitutional_provision' %}
            {% if enrichment.judgment %}
              <div class="mb-2 row d-flex align-items-center">
                <div class="col-2">
                  <strong>{% trans 'Judgment' %}:</strong>
                </div>
                <div class="col">
                  <span><a href="{{ enrichment.judgment.documents.latest_expression.first.get_absolute_url }}">{{ enrichment.judgment.documents.latest_expression.first.title }}</a></span>
                </div>
              </div>
            {% endif %}
            {% if enrichment.date_deemed_unconstitutional %}
              <div class="mb-2 row d-flex align-items-center">
                <div class="col-2">
                  <strong>{% trans 'Date deemed unconstitutional' %}:</strong>
                </div>
                <div class="col">
                  <span>{{ enrichment.date_deemed_unconstitutional }}</span>
                </div>
              </div>
            {% endif %}
            {% if enrichment.end_of_suspension_period %}
              <div class="mb-2 row d-flex align-items-center">
                <div class="col-2">
                  <strong>{% trans 'End of suspension period' %}:</strong>
                </div>
                <div class="col">
                  <span>{{ enrichment.end_of_suspension_period }}</span>
                </div>
              </div>
            {% endif %}
            {% if enrichment.date_resolved %}
              <div class="mb-2 row d-flex align-items-center">
                <div class="col-2">
                  <strong>{% trans 'Date resolved' %}:</strong>
                </div>
                <div class="col">
                  <span>{{ enrichment.date_resolved }}</span>
                </div>
              </div>
            {% endif %}
            {% if enrichment.resolving_amendment_work %}
              <div class="mb-2 row d-flex align-items-center">
                <div class="col-2">
                  <strong>{% trans 'Resolving amendment' %}:</strong>
                </div>
                <div class="col">
                  <span>
                    <a href="{{ enrichment.resolving_amendment_work.documents.latest_expression.first.get_absolute_url }}">
                      {{ enrichment.resolving_amendment_work.title }}
                    </a>
                  </span>
                </div>
              </div>
            {% endif %}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
</div>
