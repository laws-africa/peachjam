{% load i18n %}
<div>
  <div class="d-flex justify-content-between align-items-center">
    <h2>{% trans 'Saved documents' %}</h2>
    <button class="btn btn-primary"
            hx-target="#folders-list"
            hx-prompt="Give your folder a name:"
            hx-post="{% url 'folder_create' %}">
      {% trans 'New Folder' %}
    </button>
  </div>
  <div class="mb-4">{% trans "Save documents to simplify your research and stay up-to-date" %}</div>
  {% if folders %}
    {% block folder-list %}
      {% for folder in folders %}
        <div class="card mb-5" id="folder-{{ folder.pk }}">
          <div class="card-header">
            {% block folder-list-card-header %}
              <div class="justify-content-between d-flex">
                <p class="mb-0 h5">
                  <i class="bi bi-folder"></i> {{ folder.name }}
                </p>
                <div class="dropdown">
                  <div type="button"
                       data-bs-toggle="dropdown"
                       aria-expanded="false"
                       style="color: red">
                    <i class="bi bi-three-dots"></i>
                  </div>
                  <ul class="dropdown-menu">
                    {% if perms.peachjam.download_folder %}
                      <li>
                        <a href="{% url 'folder_download' folder.id %}"
                           target="_blank"
                           class="dropdown-item">
                          {% trans 'Download to Excel' %}
                        </a>
                      </li>
                    {% endif %}
                    <input id="folder_{{ forloop.counter }}"
                           type="hidden"
                           name="name"
                           value="{{ folder.name }}"/>
                    <li>
                      <a class="dropdown-item"
                         href=""
                         hx-post="{% url 'folder_delete' folder.id %}"
                         hx-target="#folders-list"
                         hx-include="#folder_{{ forloop.counter }}"
                         hx-confirm="{% trans "Are you sure you want to delete this folder? All saved documents in this folder will also be deleted." %}">{% trans 'Delete' %}</a>
                    </li>
                    <li>
                      <a class="dropdown-item"
                         href=""
                         hx-post="{% url 'folder_update' folder.id %}"
                         hx-target="#folders-list"
                         hx-prompt="Edit folder name">{% trans 'Rename' %}</a>
                    </li>
                  </ul>
                </div>
              </div>
            {% endblock %}
          </div>
          <div class="card-body">
            {% block folder-list-card-body %}
              {% if folder.saved_docs.all %}
                {% for saved_document in folder.saved_docs.all %}
                  {% include "peachjam/saved_document/_folder_list_item.html" %}
                {% endfor %}
              {% else %}
                <p>{% trans 'No saved documents.' %}</p>
              {% endif %}
            {% endblock %}
          </div>
        </div>
      {% endfor %}
    {% endblock %}
  {% else %}
    <p>You have no saved documents.</p>
  {% endif %}
</div>
