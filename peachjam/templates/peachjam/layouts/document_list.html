{% extends 'peachjam/layouts/main.html' %}
{% load i18n %}
{% block title %}{{ document.title }}{% endblock %}
{% block page-content %}
  {% block breadcrumbs %}
    <div class="mt-3">{% include 'peachjam/_entity_profile.html' %}</div>
  {% endblock %}
  {% block entity-profile %}{% endblock %}
  <div class="container pb-5" data-component="DocumentList">
    {% block page-header %}
      {% block page-title %}
        <h1 class="mt-4">{% trans 'Documents' %}</h1>
      {% endblock %}
      {% block document-count %}
        {% include 'peachjam/_document_count.html' %}
      {% endblock %}
    {% endblock %}
    {% block quick-search %}
      {% include 'peachjam/_quick_search.html' %}
    {% endblock %}
    {% block nav-tabs %}{% endblock %}
    {% block page-list-facets %}
      <div class="d-block d-lg-none my-2">
        <button class="btn btn-primary"
                type="button"
                data-bs-toggle="offcanvas"
                data-bs-target="#list-facets-offcanvas"
                aria-controls="list-facets-offcanvas">
          {% trans 'Filters' %}
        </button>
      </div>
      <div class="row">
        <div class="col-lg-3 d-none d-lg-block">
          <div>
            {% block desktop-taxonomy-list %}{% endblock %}
          </div>
          <div class="pocketlaw-hidden">
            <form method="get" id="filter-form">
              <ul class="list-group">
                <li class="position-relative list-group-item bg-light d-flex justify-content-between align-items-center">
                  <strong>{% trans 'Filters' %}</strong>
                </li>
                {% for facet_name, options in facet_data.items %}
                  <li class="list-group-item">
                    <div class="d-flex justify-content-between mb-2">
                      <strong>{{ facet_name }}</strong>
                      <div class="d-flex align-items-center">
                        <a href="{{ request.path }}"
                           hx-get="{{ request.path }}"
                           hx-target="#doc-table"
                           hx-push-url="true">Clear</a>
                      </div>
                    </div>
                    {% if facet_name == "alphabet" %}
                      <div>
                        <div class="letter-radiobox-container">
                          {% for option in options %}
                            <label class="letter-radiobox" for="{{ facet_name }}_{{ forloop.counter0 }}">
                              <input id="{{ facet_name }}_{{ forloop.counter0 }}"
                                     name="{{ facet_name }}"
                                     type="radio"
                                     hx-get="{{ request.path }}"
                                     hx-target="#doc-table"
                                     hx-push-url="true"
                                     hx-include="#filter-form"
                                     value="{{ option }}"/>
                              <span class="letter-radiobox__text">{{ option }}</span>
                            </label>
                          {% endfor %}
                        </div>
                      </div>
                    {% else %}
                      <div class="facets-scrollable">
                        {% for option in options %}
                          <div class="d-flex justify-content-between align-items-center">
                            <div class="form-check flex-grow-1">
                              <input id="{{ facet_name }}_{{ forloop.counter0 }}"
                                     class="form-check-input"
                                     name="{{ facet_name }}"
                                     type="checkbox"
                                     hx-get="{{ request.path }}"
                                     hx-target="#doc-table"
                                     hx-push-url="true"
                                     hx-include="#filter-form"
                                     value="{{ option }}"/>
                              <label class="form-check-label"
                                     for="{{ facet_name }}_{{ forloop.counter0 }}">{{ option }}</label>
                            </div>
                          </div>
                        {% endfor %}
                      </div>
                    {% endif %}
                  </li>
                {% endfor %}
              </ul>
            </form>
          </div>
        </div>
      {% endblock %}
      <div class="col-lg-9">
        <div class="position-relative">
          {% block content %}
            {% if documents %}
              {% block filter-documents %}
                <div class="mb-2 d-flex">
                  <div class="flex-grow-1 me-2">
                    <input id="filter-input"
                           form="filter-form"
                           aria-label="{% trans "Filter documents" %}"
                           placeholder="{% trans "Filter documents" %}"
                           class="form-control"
                           type="text"
                           name="q"/>
                  </div>
                  <div class="me-2">
                    <select class="form-control" name="sort" form="filter-form">
                      {% for opt in form.sort %}{{ opt }}{% endfor %}
                    </select>
                  </div>
                  <div>
                    <button hx-get="{{ request.path }}"
                            hx-target="#doc-table"
                            hx-push-url="true"
                            hx-include="#filter-form"
                            class="btn btn-primary"
                            type="submit"
                            value="Filter">
                      Filter
                    </button>
                  </div>
                </div>
              {% endblock %}
              {% include 'peachjam/_document_table.html' %}
            {% else %}
              <p>{% trans 'No documents found.' %}</p>
            {% endif %}
          {% endblock %}
        </div>
      </div>
    </div>
    {% block taxonomy-json %}{% endblock %}
  </div>
{% endblock %}
